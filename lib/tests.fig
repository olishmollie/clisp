(def test (lambda (given expected)
    (print "Test: (equal? " given " " expected ")")
    (cond ((equal? (eval given) expected) (println " --- PASS"))
          (true                           (println " --- FAIL")))))


(test '(quote a) 'a)
(test ''a (quote a))
(test ''(a b c) (quote (a b c)))

(test '(atom? nil) true)
(test '(atom? 'sym) true)
(test '(atom? "string") true)
(test '(atom? 3/4) true)
(test '(atom? 42) true)
(test '(atom? (atom? 'a)) true)
(test '(atom? +) false)
(test '(atom? '(atom? 'a)) false)
(test '(atom? (lambda (x) x)) false)
(test '(atom? '(a b c)) false)

(test '(eq? 'a 'a) true)
(test '(eq? 42 42) true)
(test '(eq? "string" "string") true)
(test '(eq? 'a 'b) false)

(test '(car '(a . b)) 'a)
(test '(car '(a b c)) 'a)

(test '(cdr '(a . b)) 'b)
(test '(cdr '(a b c)) '(b c))


(test '((lambda (x) (cons x '(b))) 'a) '(a b))
(test '((lambda (x y) (cons x (cdr y))) 'z '(a b c)) '(z b c))
(test '((lambda (f) (f '(b c))) (lambda (x) (cons 'a x))) '(a b c))

(test '((lambda () (def x 42) x)) 42)